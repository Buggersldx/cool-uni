{"version":3,"sources":["webpack:///./src/cool/ui/components/form/form.vue?6d51","webpack:///./src/cool/ui/components/form/form.vue?cdcf","webpack:///./src/cool/ui/components/form/form.vue?0a00","webpack:///./src/cool/ui/components/form/form.vue?a088","webpack:///./src/cool/ui/components/form/form.vue"],"names":["componentName","props","model","type","Object","default","rules","border","Boolean","showMessage","showToast","labelWidth","String","labelPosition","validateOnValueChange","data","subscrible","rules2","watch","model2","handler","newV","oldV","publish","action","deep","val","setRules","computed","JSON","parse","stringify","isLabelPosition","isBorder","created","methods","validate","callback","validateField","keys","i","find","e","prop","validator","AsyncValidator","form","forEach","errors","fields","resetFields","flag","map","undefined","$emit","clearValidate","$nextTick","addField","item","push","removeField","findIndex","splice","k","value"],"mappings":"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","file":"cool/ui/components/form/form.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./form.vue?vue&type=template&id=eef6efb8&\"\nvar renderjs\nimport script from \"./form.vue?vue&type=script&lang=js&\"\nexport * from \"./form.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"src/cool/ui/components/form/form.vue\"\nexport default component.exports","export * from \"-!../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--14-0!../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=template&id=eef6efb8&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n\nimport AsyncValidator from '../../utils/async-validator';\nimport { isArray, isObject, isString, isBoolean, isEmpty, diffForm } from '../../utils';\n\nexport default {\n\tcomponentName: 'ClForm',\n\n\tprops: {\n\t\tmodel: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {\n\t\t\t\treturn {};\n\t\t\t}\n\t\t},\n\t\trules: Object,\n\t\tborder: Boolean,\n\t\tshowMessage: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowToast: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tlabelWidth: {\n\t\t\ttype: String,\n\t\t\tdefault: '150rpx'\n\t\t},\n\t\tlabelPosition: {\n\t\t\ttype: String,\n\t\t\tdefault: 'right'\n\t\t},\n\t\tvalidateOnValueChange: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tsubscrible: [],\n\t\t\trules2: []\n\t\t};\n\t},\n\n\twatch: {\n\t\tmodel2: {\n\t\t\thandler(newV, oldV) {\n\t\t\t\tthis.publish({\n\t\t\t\t\tprops: diffForm(newV, oldV),\n\t\t\t\t\taction: 'validate'\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeep: true\n\t\t},\n\n\t\trules(val) {\n\t\t\tthis.setRules(val);\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tmodel2() {\n\t\t\treturn JSON.parse(JSON.stringify(this.model));\n\t\t},\n\n\t\tisLabelPosition() {\n\t\t\treturn this.labelPosition ? `cl-form--${this.labelPosition}` : '';\n\t\t},\n\n\t\tisBorder() {\n\t\t\treturn this.border ? 'cl-form--border' : '';\n\t\t}\n\t},\n\n\tcreated() {\n\t\tthis.setRules(this.rules);\n\t},\n\n\tmethods: {\n\t\t// 弥补 props 方法不能传递的问题\n\t\tsetRules(rules) {\n\t\t\tthis.rules2 = rules || {};\n\t\t},\n\n\t\t// 校验表单\n\t\tvalidate(callback) {\n\t\t\tthis.validateField(Object.keys(this.model), callback);\n\t\t},\n\n\t\t// 根据字段校验表单\n\t\tvalidateField(props, callback) {\n\t\t\tlet rules = {};\n\n\t\t\tfor (let i in this.rules2) {\n\t\t\t\tif (this.subscrible.find(e => e.prop == i)) {\n\t\t\t\t\trules[i] = this.rules2[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst validator = new AsyncValidator(rules);\n\n\t\t\tlet form = {};\n\n\t\t\tprops.forEach(e => {\n\t\t\t\tform[e] = this.model[e];\n\t\t\t});\n\n\t\t\tvalidator.validate(form, (errors, fields) => {\n\t\t\t\tthis.publish({ props, action: 'validate' });\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(!errors, errors);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t// 重置表单\n\t\tresetFields() {\n\t\t\tlet form = {};\n\t\t\tlet flag = false;\n\n\t\t\tfor (let i in this.model) {\n\t\t\t\tlet val = this.model[i];\n\n\t\t\t\tif (val) {\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\n\t\t\t\tif (isArray(val)) {\n\t\t\t\t\tform[i] = val.map(() => null);\n\t\t\t\t} else if (isObject(val)) {\n\t\t\t\t\tform[i] = {};\n\t\t\t\t} else if (isString(val)) {\n\t\t\t\t\tform[i] = '';\n\t\t\t\t} else if (isBoolean(val)) {\n\t\t\t\t\tform[i] = false;\n\t\t\t\t} else {\n\t\t\t\t\tform[i] = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (flag) {\n\t\t\t\tthis.$emit('update:model', form);\n\t\t\t}\n\n\t\t\tthis.clearValidate();\n\t\t},\n\n\t\t// 移除表单校验结果\n\t\tclearValidate(props) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.publish({ props, action: 'clear' });\n\t\t\t});\n\t\t},\n\n\t\t// 添加字段，监听事件\n\t\taddField(prop, callback) {\n\t\t\tlet item = this.subscrible.find(e => e.prop == prop);\n\n\t\t\tif (item) {\n\t\t\t\titem.handler = callback;\n\t\t\t} else {\n\t\t\t\tthis.subscrible.push({\n\t\t\t\t\tprop,\n\t\t\t\t\thandler: callback\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t// 移除字段和事件\n\t\tremoveField(prop) {\n\t\t\tconst i = this.subscrible.findIndex(e => e.prop == prop);\n\t\t\tthis.subscrible.splice(i, 1);\n\t\t},\n\n\t\t// 发布消息\n\t\tpublish({ action, props }) {\n\t\t\tlet item = null;\n\n\t\t\tif (!props) {\n\t\t\t\tprops = Object.keys(this.model);\n\t\t\t}\n\n\t\t\tprops.forEach(k => {\n\t\t\t\titem = this.subscrible.find(e => e.prop == k);\n\n\t\t\t\tif (item) {\n\t\t\t\t\titem.handler({ action, value: this.model[k] });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n};\n"],"sourceRoot":""}